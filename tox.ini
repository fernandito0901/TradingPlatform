[tox]
envlist = smoke-reports,smoke-features,smoke-models,smoke-news,smoke-scheduler

[testenv:smoke-features]
skipsdist = true
commands = python -c "import features"

[testenv:smoke-models]
skipsdist = true
commands = python -c "import models as m; assert m.train"

[testenv:smoke-news]
skipsdist = true
commands =
    python tasks/seed_news.py
    pytest tests/test_polygon.py

[testenv:smoke-scheduler]
skipsdist = true
commands = python - <<'PY'
    from trading_platform.scheduler import start
    from trading_platform.config import load_config
    cfg = load_config([])
    sched = start(cfg, interval=1)
    import time
    time.sleep(1)
    sched.shutdown()
    print("ok")
    PY
